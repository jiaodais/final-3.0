#include "LPC11xx.h"                    // Device header
#include <stdio.h>
#include <string.h>
#include "delay.h"
#define UART_BPS 9600//???????
        uint8_t  table[9]={0xff,0x07f,0x03f,0x1f,0x0f,0x07,0x03,0x01,0x00};
void UART_Init()
{
	uint16_t usFdiv;
	LPC_SYSCON->SYSAHBCLKCTRL|=(1<<16);//??IOCON??
	LPC_IOCON->PIO1_6&=~0x07;//?P1.6???
	LPC_IOCON->PIO1_6|=0x01;//?P1.6???RXD?????
	LPC_IOCON->PIO1_7&=~0x07;//?P1.7???
	LPC_IOCON->PIO1_7|=0x01;//?P1.7???TXD?????
	LPC_SYSCON->SYSAHBCLKCTRL &= ~(1<<16);//??IOCON??
	LPC_SYSCON->SYSAHBCLKCTRL |= (1<<12);//??UART??
	LPC_SYSCON->UARTCLKDIV|=0x01;//??UART??????1
	LPC_UART->LCR=0x83;//0X83????1000 0011????8????? ????? ????? ????????????
	//LCR?UART?????????????????
	
	usFdiv=(SystemCoreClock /LPC_SYSCON ->UARTCLKDIV/16)/UART_BPS;//???????????????
	LPC_UART->DLM=usFdiv/256;//????????8?
	LPC_UART->DLL=usFdiv%256;//????????8?
	//DLM?DLL??UART??????DLL??8? DLM??8?
	LPC_UART->LCR=0x03;//?????
	LPC_UART->FCR=0x07;//??FIFO ??8????
	
}
void UART_SendByte(uint8_t ucDAT)
{
		LPC_UART->THR=ucDAT;//????
		while((LPC_UART->LSR&0x40)==0);//?????,TEMT??
} 
void UART_SendStr(char  *pucStr)
{
	
		while(1)
		{
			if(*pucStr =='\0')
				break;//???????
			UART_SendByte(*pucStr++);  
		}
}
uint8_t UART_GetByte(void )
{
	uint8_t  ucRcvData;
	 while((LPC_UART->LSR&0x01)==0); 
	
	
	//??????
	
		ucRcvData=LPC_UART->RBR;//????
		return (ucRcvData);
	
}
